# Personalized-Feed-Recommendation-Service-FastAPI-CatBoost


Данный проект является частью финального проекта на курсе **«Инженер машинного обучения»** от **Karpov.Courses**.  
В рамках проекта реализован сервис персональных рекомендаций постов для пользователей.

## Функционал проекта
Проект включает в себя:

- вычисление пользовательских и постовых фичей;
- загрузку фичей в базу данных **PostgreSQL**;
- обучение модели **CatBoost** для задачи ранжирования постов;
- разработку сервиса на **FastAPI** для выдачи рекомендаций;
- эндпоинт, возвращающий **top-5 постов** для каждого пользователя.

## Модель
Модель использует `CatBoostClassifier`, обученный на следующих признаках:

- поведенческие фичи пользователей;
- статистика взаимодействий пользователей с постами;
- агрегированные статистики взаимодействий по возрастным группам;
- текстовые фичи постов:
  - средний TF-IDF по тексту,
  - максимальный TF-IDF по тексту;
- OHE-кодирование категориальных признаков:
  - темы постов (`topic`),
  - пользовательские характеристики;
- MTE-кодирование:
  - страны пользователя,
  - города пользователя.


  Итоговая метрика в коутбуке: **HitRate@5 ≥ 0.66.
  
  При тестировании в LMS курса на **2000 запросах** получено значение **0.607**.


## Как работает сервис

### Эндпоинт

| Метод | URL                     |
|------:|--------------------------|
| GET   | `/post/recommendations/` |

### Параметры запроса

| Параметр | Тип       | Описание                                   | Значение по умолчанию |
|----------|-----------|---------------------------------------------|------------------------|
| `id`     | int       | `user_id`, для которого строятся рекомендации | —                      |
| `time`   | datetime  | Текущее время запроса                        | —                      |
| `limit`  | int       | Количество возвращаемых постов               | 5                      |

### Формат ответа

| Поле   | Тип    | Описание              |
|--------|--------|-----------------------|
| `id`   | int    | Идентификатор поста   |
| `text` | string | Текст поста           |
| `topic`| string | Тема поста            |

## Основные файлы проекта

- app.py - код FastAPI-сервиса;

- app_checker.py - код для удобной проверки сервиса

- model_features.ipynb - полный пайплайн обработки данных и обучения модели;

- catboost_model.cbm - обученная модель;

- requirements.txt - файл с необходимыми версиями библиотек
